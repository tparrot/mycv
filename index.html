<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Interactive CV" />
  <title>Loading CV…</title>

  <!-- External resources – for offline usage you can download these locally -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

  <!-- We no longer use CryptoJS for encryption; instead we rely on the browser's Web Crypto API -->
  <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>

  <script src="https://d3js.org/d3.v7.min.js"></script>

  <style>
    /* ==========================================================================
       Base Colors, Layout, and Component Styles
       ========================================================================== */
    :root {
      --color-bg: #ffffff;
      --color-bg-hover: #f8f9fa;
      --color-text: #212529;
      --color-highlight: #9a9ff7;
      --color-muted: #6c757d;
      /* Fallback colors */
      --default-devops: #b3cde0;
      --default-linux: #ccebc5;
      --default-rettung: #fbb4ae;
      --default-realschule: #ebd9f4;
      --default-grundschule: #f4e8d9;
      --color-skill-bubble: #d0d9e2;
      /* High Contrast Defaults */
      --hc-bg: #000;
      --hc-text: #fff;
      --hc-border: #fff;
      --hc-toast-bg: #ff0;
      --hc-toast-text: #000;
      --hc-highlight: #ff0;
      --hc-timeline-fill: #00ffff;
      --hc-position-outline: #ffff00;
    }

    body {
      margin: 0;
      background: var(--color-bg);
      color: var(--color-text);
      font-family: "Helvetica Neue", Arial, sans-serif;
    }

    /* High Contrast Mode */
    body.high-contrast {
      font-size: 1.3rem !important;
      background-color: var(--hc-bg) !important;
      color: var(--hc-text) !important;
    }

    body.high-contrast #phone-link,
    body.high-contrast #email-link {
      font-size: 1.2rem !important;
    }

    body.high-contrast h5 {
      font-size: 1.9rem !important;
    }

    body.high-contrast h6,
    body.high-contrast h7 {
      font-size: 1.5rem !important;
    }

    body.high-contrast .btn,
    body.high-contrast .btn:hover {
      border-color: var(--hc-border) !important;
      color: var(--hc-text) !important;
      background: none !important;
      min-width: fit-content;
    }

    body.high-contrast .card,
    body.high-contrast .list-group-item {
      background: var(--hc-bg) !important;
      color: var(--hc-text) !important;
      border-color: var(--hc-border) !important;
    }

    body.high-contrast .position-card {
      border-left-color: var(--hc-position-outline);
    }

    body.high-contrast #timeline-svg-container {
      background: var(--hc-bg) !important;
      height: 15vh !important;
    }

    body.high-contrast #timeline-svg {
      background: var(--hc-bg) !important;
    }

    body.high-contrast #timeline-svg .tick {
      font-size: 2.5vw !important;
    }

    body.high-contrast .timeline-rect {
      fill: var(--hc-timeline-fill);
    }

    body.high-contrast #skill-tree-container {
      height: auto !important;
    }

    body.high-contrast .skill-bubble {
      /*outline: 4px dashed var(--hc-border) !important;*/
      border: none !important;
      background-color: var(--hc-skill-bg) !important;
      color: var(--hc-text) !important;
      position: sticky !important;
      margin: 6px !important;
      float: left !important;
      left: 0px !important;
      top: 0px !important;
      width: max-content !important;
    }

    body.high-contrast #clipboard-toast {
      outline: 4px solid var(--hc-highlight) !important;
      background-color: var(--hc-toast-bg) !important;
      color: var(--hc-toast-text) !important;
      font-size: 1.3rem !important;
      font-weight: 600 !important;
    }

    body.high-contrast #clipboard-toast .btn-close {
      background-color: var(--hc-toast-bg) !important;
    }

    body.high-contrast .accomplishment-item.hovered,
    body.high-contrast .skill-bubble.hovered,
    body.high-contrast .position-card.hovered {
      outline: 4px dashed var(--hc-highlight) !important;
    }

    body.high-contrast .position-card .text-muted,
    body.high-contrast #skill-tree-legend {
      color: var(--hc-text) !important;
    }

    body.high-contrast .highlighted {
      background-color: var(--hc-highlight-bg) !important;
      /* color: var(--hc-highlight) !important; */
    }

    body.high-contrast .copyable.btn:hover {
      background-color: var(--hc-highlight-bg) !important;
      color: var(--hc-highlight) !important;
      border-radius: 4px !important;
    }

    body.high-contrast .clipboard-btn {
      font-size: 1.5rem !important;
      color: var(--hc-highlight) !important;
      border-radius: 50%;
      outline: 2px solid var(--hc-border) !important;
    }

    body.high-contrast #skill-animation-switch {
      display: none !important;
    }

    /* Top Bar: Default layout */
    .top-buttons {
      display: flex;
      align-content: stretch;
      flex-wrap: nowrap;
      flex-direction: row;
      align-items: normal;
    }


    .top-buttons button {
      margin-left: 0.5rem;
      transition: transform 0.1s;
    }

    .passphrase-input {
      max-width: 300px;
      min-width: 150px !important;
      float: left;
    }

    #toggle-passphrase,
    #passphrase-submit {
      float: left;
    }

    /* Toast Notification */
    #clipboard-toast {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1050;
      display: none;
    }

    /* Sidebar & Sticky Elements */
    aside {
      top: 0;
      z-index: 100;
    }

    @media (min-width: 768px) {
      aside {
        position: sticky;
        top: 0;
        z-index: 100;
      }
    }

    @media (max-width: 767px) {
      .mobile aside {
        position: static;
        /* or relative, depending on your layout */
      }

      .top-buttons {
        flex-wrap: wrap;
        justify-content: center;
      }

      #passphrase-container {
        width: 100%;
        justify-content: center;
        margin-top: 0.5rem;
      }
    }

    .portrait {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      overflow: hidden;
      background: var(--color-bg);
      margin: 0 auto 1rem auto;
    }

    .copyable.btn {
      cursor: pointer;
      position: relative;
      text-decoration: none;
      color: inherit;
    }

    .clipboard-btn {
      font-size: 1rem;
      cursor: pointer;
      margin-left: 0.25rem;
      color: var(--color-muted);
      transition: transform 0.1s;
      padding: 4px;
    }

    .tooltip-custom {
      position: absolute;
      background: var(--color-highlight);
      color: #fff;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.8rem;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s;
      z-index: 100;
    }

    #phone-link,
    #email-link {
      max-width: 65%;
      word-break: break-all;
    }

    /* Position Cards */
    .position-card {
      border-left: 6px solid #ccc;
      margin-bottom: 1rem;
      transition: background-color 0.2s;
    }

    .position-card:hover {
      background-color: var(--color-bg-hover);
    }

    .list-group-item {
      background-color: unset !important;
    }

    .dimmed {
      opacity: 0.4 !important;
    }

    .highlighted {
      background-color: rgba(0, 0, 0, 0.05) !important;
    }

    #cv-timestamp {
      z-index: 100;
      position: relative;
    }

    /* Skill Tree */
    #skill-tree-container {
      position: relative;
      height: 400px;
    }

    #skill-tree-legend {
      display: flex;
      width: 100%;
    }

    #skill-animation-switch {
      display: flex;
      flex-direction: row-reverse;
      align-content: center;
      justify-content: space-evenly;
      align-items: flex-start;
    }

    .skill-bubble {
      position: absolute;
      border-radius: 16px;
      padding: 4px 8px;
      /* background-color: var(--color-skill-bubble);*/
      color: #000;
      cursor: pointer;
      text-align: center;
      transition: opacity 0.2s, transform 0.2s;
      user-select: none;
      font-size: 14px;
    }

    .skill-bubble.hovered {
      outline: 2px solid var(--color-highlight);
      z-index: 10;
    }

    .skill-bubble.selected {
      border: 2px solid var(--color-highlight);
      background-color: var(--color-highlight);
      color: #fff;
      z-index: 120;
    }

    /* Timeline */
    img,
    svg {
      overflow: visible !important;
    }

    #timeline-svg-container {
      width: 100%;
      height: 10vh;
      position: sticky;
      top: 0;
      z-index: 90;
      margin-top: 10vh;
      /*box-shadow: 0 4px 4px -2px rgba(0,0,0,0.3);
      background: var(--color-bg);*/
      overflow: show;
    }

    #timeline-svg {
      width: 100%;
      height: 100%;
      position: relative;
      top: -20px;
      overflow-y: visible;
    }

    .timeline-rect {
      cursor: pointer;
      transition: opacity 0.2s, transform 0.2s;
      fill-opacity: 0.8;
    }

    .timeline-rect:hover {
      fill-opacity: 1;
    }

    /* Accomplishments */
    .accomplishment-item {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 0.25rem;
      padding: 0.25rem 0.5rem;
      background: none;
      border: none;
      transition: background-color 0.2s;
    }

    .accomplishment-item:hover {
      background-color: var(--color-hover);
    }

    .accomplishment-item.hovered {
      background-color: var(--color-hover);
    }

    .clipboard-icon {
      visibility: hidden;
      color: var(--color-muted);
      font-size: 1rem;
      margin-left: 0.5rem;
      transition: transform 0.1s;
    }

    .accomplishment-item:hover .clipboard-icon {
      visibility: visible;
    }

    .accomplishment-item:active .clipboard-icon {
      transform: scale(0.95);
    }

    /* Print Styles */
    @media print {
      body {
        font-size: 11pt;
        margin: 0.5cm;
      }

      .position-card,
      .card,
      .accomplishment-item {
        page-break-inside: avoid;
        break-inside: avoid;
      }

      .top-buttons,
      #clipboard-toast,
      .bi.btn,
      .accomplishment-item>.btn,
      .clipboard-btn,
      #skill-animation-switch {
        display: none !important;
      }

      .container {
        width: 210mm;
        overflow: visible !important;
      }

      /* Force a desktop layout (side-by-side) */
      .row {
        display: flex !important;
        flex-direction: row !important;
      }

      /*aside,
      main {
        width: 50% !important;
      }*/
      .container, .row, aside, main {
        display: block;
        width: 100%;
        overflow: visible !important;
      }

      /* For print, force the skill tree into a flex layout so skills appear side by side */
      #skill-tree-container {
        display: flex !important;
        flex-wrap: wrap !important;
        align-items: center;
        justify-content: flex-start;
        height: auto !important;
        border: none;
      }

      .skill-bubble {
        margin: 2px;
        position: static !important;
        transform: none !important;
        outline: none !important;
      }

      /* Timeline SVG: scale to fit DIN A4 width */
      #timeline-svg-container {
        display: none !important;
      }

      /* Remove extra margins */
      .container,
      .row,
      aside,
      main {
        margin: 0;
        padding: 0;
      }
    }
  </style>
</head>

<body>
  <!-- Toast Notification -->
  <div id="clipboard-toast" class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive"
    aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body" id="clipboard-toast-text" data-i18n="clipboard_copied">
      </div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto"></button>
    </div>
  </div>

  <!-- Main Container -->
  <div class="container">
    <!-- Top Buttons (including the new passphrase input group) -->
    <div class="top-buttons p-3">
      <!-- Passphrase Unlock UI -->
      <div id="passphrase-container" class="input-group mb-2">
        <input type="password" id="passphrase-input" class="form-control passphrase-input" placeholder=""
          data-i18n="passphrase_prompt" />
        <button id="toggle-passphrase" class="btn btn-outline-secondary" type="button">
          <i class="bi bi-eye"></i>
        </button>
        <button id="passphrase-submit" class="btn btn-primary" type="button" data-i18n="passphrase_submit">
          Unlock
        </button>
      </div>
      <button id="lang-toggle" class="btn btn-outline-primary" onclick="toggleLanguage()" data-i18n="lang_toggle">
        Switch to German
      </button>
      <button id="contrast-toggle" class="btn btn-outline-primary" onclick="toggleContrast()" data-i18n="contrast_toggle">
        Toggle Accessibility
      </button>
      <button id="print-btn" class="btn btn-outline-primary" onclick="window.print()" data-i18n="print">
        Print
      </button>
    </div>
    <div id="cv-timestamp" class="text-end small mb-2"></div>
    <div class="row g-3">
      <!-- LEFT SIDEBAR: Personal Info, Skill Tree, Certificates -->
      <aside class="col-md-4">
        <!-- Personal Info Card -->
        <div class="card mb-3">
          <div class="card-body text-center">
            <div class="portrait">
              <img id="portrait-image" alt="Portrait Picture" style="width: 100%; height: 100%" />
            </div>
            <h2 class="card-title h4">
              <span class="copyable" data-copy="" data-i18n="name"></span>
              <i class="bi bi-clipboard clipboard-btn"></i>
            </h2>
            <p class="card-text" data-i18n="title"></p>
            <p>
              <i class="bi bi-geo-alt"></i>
              <span data-i18n="birthplace"></span>
            </p>
            <p>
              <i class="bi bi-calendar-event"></i>
              <span data-i18n="dob"></span>
            </p>
            <p>
              <i class="bi bi-telephone"></i>
              <a href="#" id="phone-link" class="copyable btn btn-light btn-sm" data-copy="" data-i18n="phone"></a>
              <i class="bi bi-clipboard clipboard-btn"></i>
            </p>
            <p>
              <i class="bi bi-envelope"></i>
              <a href="#" id="email-link" class="copyable btn btn-light btn-sm" data-copy="" data-i18n="email"></a>
              <i class="bi bi-clipboard clipboard-btn"></i>
            </p>
            <p>
              <i class="bi bi-globe"></i>
              <span data-i18n="languages"></span>
            </p>
          </div>
        </div>
        <!-- Skill Tree Card -->
        <div class="card mb-3">
          <div class="card-body">
            <h5 class="text-center" data-i18n="skills"></h5>
            <div id="skill-tree-container"></div>
            <p id="skill-tree-legend" class="text-center text-muted small mt-2" data-i18n="skills_legend">
            </p>
          </div>
        </div>
        <!-- Certificates & Accomplishments Card -->
        <div class="card">
          <div class="card-body">
            <h5 class="text-center">Certificates &amp; Accomplishments</h5>
            <div id="accomplishments-list" class="mt-2"></div>
          </div>
        </div>
      </aside>
      <!-- RIGHT COLUMN: Timeline & Positions -->
      <main class="col-md-8" style="overflow-y: auto; min-height: calc(100vh - 60px)">
        <div id="timeline-card" class="mb-2">
          <h5 class="text-center" data-i18n="timeline"></h5>
          <div id="timeline-svg-container">
            <svg id="timeline-svg"></svg>
          </div>
        </div>
        <div id="position-list"></div>
      </main>
    </div>
    <!-- Extra Content Container (if needed) -->
    <div id="extra-content-container" class="mt-3"></div>
  </div>

  <!-- Embedded Default YAML Configuration -->
  <script id="default-config" type="text/x-yaml">
      page_title: "DevOps Engineer CV for John Doe"
      cv_timestamp: "2025-03-13"
      personal_info:
        name: "John Doe"
        title: "DevOps Engineer"
        birthplace: "New York, USA"
        dob: "1980-01-01"
        phone: "+1 123-456-7890"
        email: "john.doe@example.com"
        #image: "https://img.freepik.com/fotos-kostenlos/die-rote-oder-weisse-katze-ich-auf-weissem-studio_155003-13189.jpg?semt=ais_hybrid"
        languages: "English, German"
        email_tooltip_en: "Click to send mail"
        email_tooltip_de: "Mail senden"
        phone_tooltip_en: "Click to call"
        phone_tooltip_de: "Anrufen"

      positions:
        - id: "devops"
          color: "#b3cde0"
          translations:
            en:
              title: "DevOps Engineer"
              company: "DevOps Company (former DEVYOPY.org)"
              description:
                - type: paragraph
                  text: "Implemented CI/CD via GitHub, automated monitoring with OpsGenie and CloudWatch. And generally following parts:"
                - type: list
                  items:
                    - "Designed service and infrastructure architecture"
                    - "Practiced Scrum"
                    - "Used Terraform and AWS"
                - type: paragraph
                  text: "And much more."
            de:
              title: "DevOps Engineer"
              company: "DevOps Company (früher DEVYOPY.org)"
              description: "Implementierung von CI/CD über GitHub Enterprise, automatisierte Überwachung mit CloudWatch, Planung und Umsetzung von Service- und Infrastrukturlösungen, Scrum, Terraform und AWS."
          start: "2016-08"
          end: "2023-03"
          skills: ["AWS", "CI/CD", "Kubernetes"]
        - id: "apprenticeship"
          color: "#ccebc5"
          company: "Company org, Rivertown"
          translations:
            en:
              title: "Apprenticeship as a Systems Engineer"
              description: "Focused on observability, logging, and automation."
            de:
              title: "Duale Ausbildung Fachinformatiker für Systemintegration"
              description:
                - type: paragraph
                  text: 'Fokussiert auf Monitoring, Logging und Automatisierung'
                - type: list
                  items:
                    - "Weiterbildung in Linux und Windows"
                    - "Gemeinsame Projektarbeit and Terminalservern"
                - type: paragraph
                  text: 'Ich erreichte einen erfolgreichen Abschluss nach verkürzter Ausbildungszeit'
          start: "2013-08"
          end: "2016-07"
          skills: ["Monitoring", "Bash", "Linux", "networking"]
        - id: "volunteering"
          color: "#fbd9a4"
          translations:
            en:
              title: "Early volunteer work"
              description: "Even as a youngster, I was involved in the local chapter of the German Red Cross."
            de:
              title: "Frühe ehrenamtliche Arbeit"
              description: "Schon als Jugendlicher habe ich im Ortsverein des Deutschen Roten Kreuzes mitgewirkt."
          start: "2000-05"
          end: "2016-07"
          skills: ["social", "empathy", "responsibility"]
        - id: "secondary"
          color: "#ebd9f4"
          translations:
            en:
              title: "Secondary School"
              description: ""
            de:
              title: "Realschule"
              description: ""
          start: "2001-08"
          end: "2007-07"
          skills: []
        - id: "elementary"
          color: "#f4e8d9"
          translations:
            en:
              title: "Elementary School"
              description: ""
            de:
              title: "Grundschule"
              description: ""
          start: "1995-08"
          end: "2001-07"
          skills: []
      skills:
        - id: "AWS"
          level: 10
          positions: ["devops"]
        - id: "Linux"
          level: 12
          positions: ["apprenticeship", "admin"]
        - id: "networking"
          level: 4
          positions: ["apprenticeship", "admin"]
          translations:
            en:
              title: "Networking"
            de:
              title: "Netzwerktechnik"
        - id: "Bash"
          level: 10
          positions: ["apprenticeship", "admin"]
        - id: "social"
          level: 7
          positions: ["apprenticeship", "volunteering"]
          translations:
            en:
              title: "Social Interaction"
            de:
              title: "Sozialkompetenz"

      accomplishments:
        - label: "volunteering"
          positions: ["volunteering"]
          skills: ["empathy", "social"]
          attachment: "certificate-volunteering.pdf"
          translations:
            en:
              label: "Volunteering Year Certificate"
            de:
              label: "FSJ-Bescheinigung"
        - label: "lpic1"
          positions: ["apprenticeship"]
          skills: ["linux", "bash", "networking"]
          attachment: "certificate-medical.pdf"
          translations:
            en:
              label: "LPIC-1 Zertifizierung"
            de:
            label: "LPIC-1 Zertifizierung"
        - label: "elementaryschoolcertificate"
          positions: ["elementary"]
          skills: ["music", "painting", "dancing"]
          attachment: "es-cert.pdf"
          translations:
            en:
              label: "Elementary School Certificate"
            de:
              label: "Grundschulabschlusszeugnis"

      translations:
        en:
          timeline: "My Timeline"
          skills: "My Mix of Skills"
          skills_legend: "Larger skill tags indicate higher expertise/experience."
          clipboard_copied: "Copied to clipboard"
          skill_filter_toast: "Showing positions with skill: {skill}"
          skill_filter_clear_toast: "Skill filter removed"
          lang_toggle: "Switch to German"
          contrast_toggle: "Toggle Accessibility"
          print: "Print"
          passphrase_submit: "Unlock"
          passphrase_prompt: "Enter passphrase"
          passphrase_required: "Passphrase is required to decrypt configuration."
          decryption_failed: "Decryption failed: {error}"
          decryption_error: "Decryption error: {error}"
          decryption_success: "Configuration unlocked successfully!"
          disable_skill_animation: "Static Layout"
          empty_decryption_result: "Empty decryption result. Possibly an incorrect passphrase."
          invalid_key_material: "Key material is not a CryptoKey"
          yaml_parse_failed: "YAML parsing failed: {error}"
        de:
          timeline: "Mein Lebenslauf"
          skills: "Meine Fähigkeiten"
          skills_legend: "Größere Skill-Tags deuten auf höhere Expertise/Erfahrung hin."
          clipboard_copied: "Kopiert!"
          skill_filter_toast: "Zeige Positionen mit {skill}"
          skill_filter_clear_toast: "Skillfilter entfernt"
          lang_toggle: "Auf Englisch wechseln"
          contrast_toggle: "Barrierefreiheit umschalten"
          print: "Drucken"
          passphrase_submit: "Entsperren"
          passphrase_prompt: "Passwort eingeben"
          passphrase_required: "Passphrase ist erforderlich, um die Konfiguration zu entschlüsseln."
          decryption_failed: "Entschlüsselung fehlgeschlagen: {error}"
          decryption_error: "Entschlüsselungsfehler: {error}"
          decryption_success: "Konfiguration erfolgreich freigeschaltet!"
          disable_skill_animation: "Statische Ansicht"
          empty_decryption_result: "Leeres Ergebnis der Entschlüsselung. Möglicherweise ist das Passwort falsch."
          invalid_key_material: "Schlüsselmateriel ist kein CryptoKey"
          yaml_parse_failed: "YAML-Parsing fehlgeschlagen: {error}"
        </script>
  <script id="custom-config" type="text/plain">
{"salt":"BjGZlveWVISFQH6Mf7ImmQ==","iv":"T6us6RQPQ8pA+mAy","ciphertext":"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"}
</script>
  <!-- Main JavaScript -->
  <script>
    /*<![CDATA[*/
    function hexToRgb(hex) {
      hex = hex.replace(/^#/, "");
      if (hex.length === 3)
        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
      if (hex.length !== 6) return null;
      return {
        r: parseInt(hex.substring(0, 2), 16),
        g: parseInt(hex.substring(2, 4), 16),
        b: parseInt(hex.substring(4, 6), 16),
      };
    }
    function rgbToHex(r, g, b) {
      const toHex = (c) => ("0" + c.toString(16)).slice(-2);
      return "#" + toHex(r) + toHex(g) + toHex(b);
    }
    function generateHCColor(hex) {
      const rgb = hexToRgb(hex);
      if (!rgb) return "#FFFF00";
      let channels = [
        { key: "r", value: rgb.r },
        { key: "g", value: rgb.g },
        { key: "b", value: rgb.b },
      ].sort((a, b) => b.value - a.value);
      rgb[channels[0].key] = Math.min(
        255,
        Math.floor(rgb[channels[0].key] * 5)
      );
      rgb[channels[1].key] = Math.min(
        255,
        Math.floor(rgb[channels[1].key] * 2)
      );
      rgb[channels[2].key] = Math.min(
        255,
        Math.floor(rgb[channels[2].key] / 5)
      );
      return rgbToHex(rgb.r, rgb.g, rgb.b);
    }
    function getDefaultColor(id) {
      const palette = [
        "#b3cde0",
        "#ccebc5",
        "#fbb4ae",
        "#ebd9f4",
        "#f4e8d9",
        "#D0D9E2",
        "#C3C2D5",
      ];
      let hash = 0;
      for (let i = 0; i < id.length; i++) {
        hash = id.charCodeAt(i) + ((hash << 5) - hash);
      }
      const index = Math.abs(hash) % palette.length;
      return palette[index];
    }
    function getPositionColor(id) {
      const pos = config.positions.find((p) => p.id === id);
      let normal = pos && pos.color ? pos.color : getDefaultColor(id);
      let highContrast =
        pos && pos.highContrastColor
          ? pos.highContrastColor
          : generateHCColor(normal);
      return { normal, highContrast };
    }
    function renderContent(content) {
      if (typeof content === "string") {
        const p = document.createElement("p");
        p.innerHTML = content.replace(/\n/g, "<br>");
        return p;
      }
      if (Array.isArray(content)) {
        const fragment = document.createDocumentFragment();
        content.forEach((item) => {
          fragment.appendChild(renderContent(item));
        });
        return fragment;
      }
      if (typeof content === "object" && content !== null) {
        if (content.type === "paragraph") {
          const p = document.createElement("p");
          p.innerHTML = content.text
            ? content.text.replace(/\n/g, "<br>")
            : "";
          return p;
        } else if (content.type === "list") {
          const ul = document.createElement("ul");
          ul.className = "list-group list-group-flush";
          if (Array.isArray(content.items)) {
            content.items.forEach((item) => {
              const li = document.createElement("li");
              li.className = "list-group-item";
              li.appendChild(renderContent(item));
              ul.appendChild(li);
            });
          }
          return ul;
        } else {
          const p = document.createElement("p");
          p.innerHTML = content.text
            ? content.text.replace(/\n/g, "<br>")
            : "";
          return p;
        }
      }
      return document.createElement("div");
    }
    function showToastSkillFilter(skillName) {
      const toastEl = document.getElementById("clipboard-toast");
      const toastText = document.getElementById("clipboard-toast-text");
      if (skillName) {
        let msgTemplate =
          config.translations[currentLanguage].skill_filter_toast ||
          "Showing positions with skill: {skill}";
        toastText.textContent = msgTemplate.replace("{skill}", skillName);
      } else {
        let msg =
          config.translations[currentLanguage].skill_filter_clear_toast ||
          "Skill filter removed";
        toastText.textContent = msg;
      }
      toastEl.style.display = "block";
      setTimeout(() => {
        toastEl.style.display = "none";
      }, 2000);
    }
    function updateTranslations() {
      const trans = config.translations;
      document.querySelectorAll("[data-i18n]").forEach((el) => {
        const key = el.getAttribute("data-i18n");
        if (trans[currentLanguage] && trans[currentLanguage][key]) {
          if (el.hasAttribute("placeholder")) {
            el.setAttribute("placeholder", trans[currentLanguage][key]); // Update placeholders
          } else {
            el.textContent = trans[currentLanguage][key]; // Update text content
          }
        }
      });

      document.getElementById("lang-toggle").textContent =
        currentLanguage === "en" ? "Switch to German" : "Switch to English";
      const emailLink = document.getElementById("email-link");
      if (emailLink) {
        emailLink.title =
          currentLanguage === "en"
            ? config.personal_info.email_tooltip_en
            : config.personal_info.email_tooltip_de;
      }
      const phoneLink = document.getElementById("phone-link");
      if (phoneLink) {
        phoneLink.title =
          currentLanguage === "en"
            ? config.personal_info.phone_tooltip_en
            : config.personal_info.phone_tooltip_de;
      }
      document.querySelectorAll(".position-card").forEach((card) => {
        const pid = card.getAttribute("data-id");
        const pos = config.positions.find((p) => p.id === pid);
        if (pos && pos.translations && pos.translations[currentLanguage]) {
          const t = pos.translations[currentLanguage];
          card.querySelector("h5").textContent = t.title || pos.title;
          card.querySelector("h6").textContent = t.company || pos.company;
          let descContainer = card.querySelector(".position-description");
          if (!descContainer) {
            descContainer = document.createElement("div");
            descContainer.classList.add("position-description");
            card.appendChild(descContainer);
          }
          descContainer.innerHTML = "";
          if (t.description || pos.description) {
            descContainer.appendChild(
              renderContent(t.description || pos.description)
            );
          }
        }
      });
      d3.selectAll(".skill-bubble").each(function (d) {
        if (
          d.translations &&
          d.translations[currentLanguage] &&
          d.translations[currentLanguage].title
        ) {
          d3.select(this).text(d.translations[currentLanguage].title);
        } else {
          d3.select(this).text(d.id);
        }
      });
      document.querySelectorAll(".accomplishment-item").forEach((item) => {
        const accData = item.dataset.acc
          ? JSON.parse(item.dataset.acc)
          : null;
        if (
          accData &&
          accData.translations &&
          accData.translations[currentLanguage] &&
          accData.translations[currentLanguage].label
        ) {
          const span = item.querySelector("span");
          if (span)
            span.textContent = accData.translations[currentLanguage].label;
        }
      });
      document
        .querySelectorAll(".position-badges span.badge")
        .forEach((badge) => {
          let skillId =
            badge.getAttribute("data-skill") || badge.textContent.trim();
          const skillObj = config.skills.find((s) => s.id === skillId);
          if (
            skillObj &&
            skillObj.translations &&
            skillObj.translations[currentLanguage] &&
            skillObj.translations[currentLanguage].title
          ) {
            badge.textContent = skillObj.translations[currentLanguage].title;
          } else {
            badge.textContent = skillId;
          }
        });
    }
    function toggleLanguage() {
      currentLanguage = currentLanguage === "en" ? "de" : "en";
      updateTranslations();
    }
    function updateColors() {
      document.querySelectorAll(".position-card").forEach((card) => {
        const { normal, highContrast } = getPositionColor(
          card.getAttribute("data-id")
        );
        card.style.setProperty(
          "border-left-color",
          document.body.classList.contains("high-contrast")
            ? highContrast
            : normal,
          "important"
        );
      });
      applyTimelineColors();
    }
    function toggleContrast() {
      document.body.classList.toggle("high-contrast");
      updateColors();
    }
    function populatePersonalInfo(info) {
      const nameEl = document.querySelector('[data-i18n="name"]');
      if (nameEl) {
        nameEl.textContent = info.name;
        nameEl.setAttribute("data-copy", info.name);
      }
      const titleEl = document.querySelector('[data-i18n="title"]');
      if (titleEl) titleEl.textContent = info.title;
      const birthEl = document.querySelector('[data-i18n="birthplace"]');
      if (birthEl) birthEl.textContent = info.birthplace;
      const dobEl = document.querySelector('[data-i18n="dob"]');
      if (dobEl) dobEl.textContent = info.dob;
      const phoneEl = document.querySelector('[data-i18n="phone"]');
      if (phoneEl) {
        phoneEl.textContent = info.phone;
        phoneEl.setAttribute("data-copy", info.phone);
      }
      const langEl = document.querySelector('[data-i18n="languages"]');
      if (langEl) langEl.textContent = info.languages;
      const emailElem = document.querySelector('[data-i18n="email"]');
      if (emailElem) {
        emailElem.textContent = info.email;
        emailElem.setAttribute("data-copy", info.email);
      }
      const emailLink = document.getElementById("email-link");
      if (emailLink) emailLink.href = `mailto:"${info.name}"<${info.email}>`;
      const phoneLink = document.getElementById("phone-link");
      if (phoneLink)
        phoneLink.href = "tel:" + info.phone.replace(/[^0-9+]/g, "");

      const profileImageSrc = getProfileImage(info.email, info.image);
      const imgElement = document.getElementById("portrait-image");
      if (imgElement) imgElement.src = profileImageSrc;
    }
    function populatePositions(positions) {
      const container = document.getElementById("position-list");
      container.innerHTML = "";
      positions.forEach((pos) => {
        const card = document.createElement("div");
        card.classList.add("card", "position-card", "p-3");
        card.setAttribute("data-id", pos.id);
        card.setAttribute("data-start", pos.start);
        card.setAttribute("data-end", pos.end);
        card.setAttribute("data-company", pos.company);
        card.setAttribute("data-skills", (pos.skills || []).join(","));
        const { normal, highContrast } = getPositionColor(pos.id);
        card.style.setProperty(
          "border-left-color",
          document.body.classList.contains("high-contrast")
            ? highContrast
            : normal,
          "important"
        );
        const t =
          pos.translations && pos.translations[currentLanguage]
            ? pos.translations[currentLanguage]
            : {};
        const title = t.title || pos.title || pos.id;
        card.innerHTML = `<h5 class="card-title mb-1">${title}</h5>
      <h6 class="card-subtitle mb-1 text-muted company">${pos.company}</h6>
      <h7 class="card-subtitle mb-2 text-muted date"><span class="start-date">${pos.start}</span> – <span class="end-date">${pos.end}</span></h7>`;
        const descContainer = document.createElement("div");
        descContainer.classList.add("position-description", "card-text");
        if (t.description || pos.description) {
          descContainer.appendChild(
            renderContent(t.description || pos.description)
          );
        }
        card.appendChild(descContainer);
        if (pos.skills && pos.skills.length > 0) {
          const badgeContainer = document.createElement("div");
          badgeContainer.classList.add("position-badges");
          pos.skills.forEach((skill) => {
            const badge = document.createElement("span");
            badge.classList.add("badge", "bg-secondary", "ms-1");
            badge.setAttribute("data-skill", skill);
            badge.textContent = skill;
            badge.style.cursor = "pointer";
            badge.addEventListener("click", function (event) {
              event.stopPropagation();
              if (selectedSkill === skill) {
                selectedSkill = null;
                d3.selectAll(".skill-bubble").classed("selected", false);
                document
                  .querySelectorAll(".position-card")
                  .forEach((card) => {
                    card.classList.remove("dimmed", "highlighted");
                  });
                showToastSkillFilter("");
              } else {
                selectedSkill = skill;
                d3.selectAll(".skill-bubble").classed("selected", false);
                d3.selectAll(".skill-bubble")
                  .filter(function (d) {
                    return d.id === skill;
                  })
                  .classed("selected", true);
                document
                  .querySelectorAll(".position-card")
                  .forEach((card) => {
                    const skills = card
                      .getAttribute("data-skills")
                      .split(",")
                      .map((s) => s.trim());
                    if (skills.includes(skill)) {
                      card.classList.add("highlighted");
                      card.classList.remove("dimmed");
                    } else {
                      card.classList.add("dimmed");
                    }
                  });
                let skillName = skill;
                d3.selectAll(".skill-bubble").each(function (d) {
                  if (
                    d.id === skill &&
                    d.translations &&
                    d.translations[currentLanguage] &&
                    d.translations[currentLanguage].title
                  ) {
                    skillName = d.translations[currentLanguage].title;
                  }
                });
                showToastSkillFilter(skillName);
              }
            });
            badgeContainer.appendChild(badge);
          });
          card.style.position = "relative";
          card.appendChild(badgeContainer);
        }
        container.appendChild(card);
      });
    }

    function populateSkills(skills) {
      window.skillData = skills;
      initSkillTree();
    }

    function addSkillAnimationSwitch() {
      // Only add the switch in normal mode (not in high-contrast)
      if (document.body.classList.contains("high-contrast")) return;
      let switchContainer = document.getElementById("skill-animation-switch");
      if (!switchContainer) {
        switchContainer = document.createElement("div");
        switchContainer.id = "skill-animation-switch";
        switchContainer.className = "form-check mt-2 card p-1";
        switchContainer.innerHTML = `
      <input class="form-check-input" type="checkbox" id="disable-animation-switch">
      <label class="form-check-label" for="disable-animation-switch" data-i18n="disable_skill_animation">
        Static Layout
      </label>
    `;
        // Append the switch below the skill tree container
        document.getElementById("skill-tree-container").parentElement.appendChild(switchContainer);
        document.getElementById("disable-animation-switch").addEventListener("change", function () {
          disableSkillAnimation = this.checked;
          initSkillTree();
        });
      }
    }


    function initSkillTree() {
      const container = d3.select("#skill-tree-container");
      const width = container.node().clientWidth;
      const height = container.node().clientHeight;
      container.selectAll(".skill-bubble").remove();
      const nodes = window.skillData.map(d => Object.assign({}, d));
      const skillBubbles = container.selectAll(".skill-bubble")
        .data(nodes)
        .enter()
        .append("button")
        .attr("type", "button")
        .attr("class", "skill-bubble btn btn-light")
        .style("font-size", d => (10 + d.level * 2) + "px")
        .text(d => (d.translations && d.translations[currentLanguage] && d.translations[currentLanguage].title) ? d.translations[currentLanguage].title : d.id);

      // Attach hover events on desktop only
      if (!document.body.classList.contains("mobile")) {
        skillBubbles.on("mouseenter", (evt, d) => {
          d3.select(evt.currentTarget).classed("hovered", true);
          highlightPositions(d.positions);
          highlightSkillBubbles([d.id]);
        });
        skillBubbles.on("mouseleave", (evt, d) => {
          d3.select(evt.currentTarget).classed("hovered", false);
          if (!selectedSkill) {
            unhighlightAllPositions();
            unhighlightAllSkills();
          }
        });
      }
      // Always attach click events
      skillBubbles.on("click", function (event, d) {
        event.stopPropagation();
        if (selectedSkill === d.id) {
          selectedSkill = null;
          d3.selectAll(".skill-bubble").classed("selected", false);
          document.querySelectorAll(".position-card").forEach(card => {
            card.classList.remove("dimmed", "highlighted");
          });
          showToastSkillFilter("");
        } else {
          selectedSkill = d.id;
          d3.selectAll(".skill-bubble").classed("selected", false);
          d3.select(this).classed("selected", true);
          document.querySelectorAll(".position-card").forEach(card => {
            const skills = card.getAttribute("data-skills").split(",").map(s => s.trim());
            if (skills.includes(d.id)) {
              card.classList.add("highlighted");
              card.classList.remove("dimmed");
            } else {
              card.classList.add("dimmed");
            }
          });
          let skillName = (d.translations && d.translations[currentLanguage] && d.translations[currentLanguage].title) ? d.translations[currentLanguage].title : d.id;
          showToastSkillFilter(skillName);
        }
      });

      // If animation is enabled, run simulation; otherwise use static layout
      if (!disableSkillAnimation) {
        const simulation = d3.forceSimulation(nodes)
          .force("charge", d3.forceManyBody().strength(-60))
          .force("x", d3.forceX(width / 2).strength(0.16))
          .force("y", d3.forceY(height / 2).strength(0.16))
          .force("collision", d3.forceCollide().radius(d => 20 + d.level * 4).iterations(2))
          .on("tick", () => {
            skillBubbles
              .style("left", d => Math.max(0, Math.min(width - 130, d.x)) + "px")
              .style("top", d => Math.max(0, Math.min(height - 50, d.y)) + "px");
          });
        simulation.alphaTarget(0.2).restart();
      } else {
        // Static layout: remove absolute positioning so bubbles flow naturally
        skillBubbles.style("position", "static");
      }
      addSkillAnimationSwitch();
    }

    function toDate(dateStr) {
      const parseDate = d3.timeParse("%Y-%m");
      const parseYear = d3.timeParse("%Y");
      return dateStr.includes("-") ? parseDate(dateStr) : parseYear(dateStr);
    }
    function initTimeline() {
      const positions = Array.from(
        document.querySelectorAll(".position-card")
      )
        .reverse()
        .map((card) => {
          const pid = card.getAttribute("data-id");
          const startStr = card.getAttribute("data-start");
          const endStr = card.getAttribute("data-end");
          const skills = (card.getAttribute("data-skills") || "")
            .split(",")
            .map((s) => s.trim())
            .filter(Boolean);
          return {
            id: pid,
            start: startStr,
            end: endStr,
            skills,
            startDate: toDate(startStr),
            endDate: toDate(endStr),
          };
        });
      if (!positions.length) return;
      const minDate = d3.min(positions, (d) => d.startDate);
      const maxDate = d3.max(positions, (d) => d.endDate);
      const svgEl = document.getElementById("timeline-svg");
      const width = svgEl.clientWidth;
      const height = svgEl.clientHeight;
      const svg = d3.select(svgEl);
      svg.selectAll("*").remove();
      const xScale = d3
        .scaleTime()
        .domain([minDate, maxDate])
        .range([50, width - 50]);
      const xAxis = d3.axisBottom(xScale).ticks(5);
      svg
        .append("g")
        .attr("transform", `translate(0, ${height - 20})`)
        .call(xAxis);
      let tooltip = d3.select("body").select("#timeline-tooltip");
      if (tooltip.empty()) {
        tooltip = d3
          .select("body")
          .append("div")
          .attr("id", "timeline-tooltip")
          .attr("class", "tooltip-custom");
      }
      svg
        .selectAll(".timeline-rect")
        .data(positions)
        .enter()
        .append("rect")
        .attr("class", "timeline-rect")
        .attr("data-id", (d) => d.id)
        .attr("x", (d) => xScale(d.startDate))
        .attr("y", height - 70)
        .attr("width", (d) =>
          Math.max(5, xScale(d.endDate) - xScale(d.startDate))
        )
        .attr("height", 40)
        .attr("fill", (d) => {
          const { normal, highContrast } = getPositionColor(d.id);
          return document.body.classList.contains("high-contrast")
            ? highContrast
            : normal;
        })
        .on("mouseenter", function (event, d) {
          const card = document.querySelector(
            `.position-card[data-id='${d.id}']`
          );
          if (card) card.classList.add("highlighted");
          highlightSkillBubbles(d.skills);
          highlightAccomplishments({ positions: [d.id], skills: d.skills });
          const posConfig = config.positions.find((p) => p.id === d.id);
          const posTitle =
            posConfig &&
              posConfig.translations &&
              posConfig.translations[currentLanguage]
              ? posConfig.translations[currentLanguage].title
              : posConfig
                ? posConfig.title
                : d.id;
          tooltip
            .html(`Position: ${posTitle}<br>From: ${d.start}<br>To: ${d.end}`)
            .style("opacity", 1)
            .style("left", event.pageX + 10 + "px")
            .style("top", event.pageY + 10 + "px");
        })
        .on("mousemove", function (event) {
          tooltip
            .style("left", event.pageX + 10 + "px")
            .style("top", event.pageY + 10 + "px");
        })
        .on("mouseleave", function (event, d) {
          const card = document.querySelector(
            `.position-card[data-id='${d.id}']`
          );
          if (card) card.classList.remove("highlighted");
          unhighlightAllSkills();
          unhighlightAccomplishments();
          tooltip.style("opacity", 0);
        })
        .on("click", function (event, d) {
          const card = document.querySelector(
            `.position-card[data-id='${d.id}']`
          );
          if (card)
            card.scrollIntoView({ behavior: "smooth", block: "center" });
        });
      applyTimelineColors();
      positionRects(xScale);
    }
    function applyTimelineColors() {
      document.querySelectorAll(".timeline-rect").forEach((rect) => {
        const d = rect.__data__;
        const { normal, highContrast } = getPositionColor(d.id);
        rect.style.fill = document.body.classList.contains("high-contrast")
          ? highContrast
          : normal;
      });
    }
    function positionRects(xScale) {
      const rects = d3.selectAll(".timeline-rect");
      const occupied = [];
      rects.each(function (d) {
        const rect = d3.select(this);
        const x = xScale(d.startDate);
        const width = Math.max(5, xScale(d.endDate) - xScale(d.startDate));
        const height = 40;
        let y = height + 0;
        let overlapping = true;
        while (overlapping) {
          overlapping = false;
          for (const occupiedRect of occupied) {
            if (
              x < occupiedRect.x + occupiedRect.width &&
              x + width > occupiedRect.x &&
              y < occupiedRect.y + occupiedRect.height &&
              y + height > occupiedRect.y
            ) {
              y -= 2;
              overlapping = true;
              break;
            }
          }
        }
        rect.attr("y", y);
        occupied.push({ x, y, width, height });
      });
    }
    function highlightPositions(posIds) {
      document.querySelectorAll(".position-card").forEach((card) => {
        const cID = card.getAttribute("data-id");
        if (!posIds.includes(cID)) {
          card.classList.add("dimmed");
        } else {
          card.classList.remove("dimmed");
          card.classList.add("highlighted");
        }
      });
    }
    function unhighlightAllPositions() {
      document
        .querySelectorAll(".position-card")
        .forEach((card) => card.classList.remove("dimmed", "highlighted"));
    }
    function highlightSkillBubbles(skillNames) {
      const container = d3.select("#skill-tree-container");
      container.selectAll(".skill-bubble").each(function (sd) {
        if (skillNames.includes(sd.id))
          d3.select(this).classed("hovered", true);
        else d3.select(this).classed("dimmed", true);
      });
    }
    function unhighlightAllSkills() {
      const container = d3.select("#skill-tree-container");
      container
        .selectAll(".skill-bubble")
        .classed("hovered", false)
        .classed("dimmed", false);
    }
    function highlightAccomplishments(criteria) {
      document.querySelectorAll(".accomplishment-item").forEach((acc) => {
        const accPositions = (acc.getAttribute("data-positions") || "")
          .split(",")
          .map((s) => s.trim());
        const accSkills = (acc.getAttribute("data-skills") || "")
          .split(",")
          .map((s) => s.trim());
        const posMatch =
          criteria.positions &&
          criteria.positions.some((p) => accPositions.includes(p));
        const skillMatch =
          criteria.skills &&
          criteria.skills.some((s) => accSkills.includes(s));
        if (posMatch || skillMatch) acc.classList.add("hovered");
        else acc.classList.remove("hovered");
      });
    }
    function unhighlightAccomplishments() {
      document
        .querySelectorAll(".accomplishment-item")
        .forEach((acc) => acc.classList.remove("hovered"));
    }
    function initButtonBounceEffect() {
      document.querySelectorAll(".btn, .clipboard-btn").forEach((btn) => {
        btn.addEventListener("mousedown", () => {
          btn.style.transform = "scale(0.95)";
        });
        btn.addEventListener("mouseup", () => {
          btn.style.transform = "scale(1)";
        });
        btn.addEventListener("mouseleave", () => {
          btn.style.transform = "scale(1)";
        });
      });
    }
    function initClipboardHandlers() {
      document.querySelectorAll(".copyable").forEach((elem) => {
        const clipboardIcon =
          elem.parentElement.querySelector(".clipboard-btn");
        if (clipboardIcon) {
          clipboardIcon.addEventListener("mousedown", () => {
            clipboardIcon.style.transform = "scale(0.95)";
          });
          clipboardIcon.addEventListener("mouseup", () => {
            clipboardIcon.style.transform = "scale(1)";
            const text = elem.getAttribute("data-copy") || elem.textContent;
            copyTextToClipboard(text);
          });
        }
        elem.addEventListener("mousedown", () => {
          elem.style.transform = "scale(0.95)";
        });
        elem.addEventListener("mouseup", () => {
          elem.style.transform = "scale(1)";
        });
      });
    }
    function copyTextToClipboard(text) {
      navigator.clipboard.writeText(text).then(() => {
        showToast();
      });
    }
    function showToast() {
      const toastEl = document.getElementById("clipboard-toast");
      const toastText = document.getElementById("clipboard-toast-text");
      toastText.textContent =
        config.translations[currentLanguage].clipboard_copied;
      toastEl.style.display = "block";
      setTimeout(() => {
        toastEl.style.display = "none";
      }, 2000);
    }
    function populateAccomplishments(accomplishments) {
      const container = document.getElementById("accomplishments-list");
      container.innerHTML = "";
      accomplishments.forEach((ac) => {
        const item = document.createElement("div");
        item.classList.add("accomplishment-item");
        item.setAttribute("data-positions", ac.positions.join(","));
        item.setAttribute("data-skills", ac.skills.join(","));
        item.dataset.acc = JSON.stringify(ac);
        let labelText = ac.label;
        if (
          ac.translations &&
          ac.translations[currentLanguage] &&
          ac.translations[currentLanguage].label
        ) {
          labelText = ac.translations[currentLanguage].label;
        }
        item.innerHTML = `<span>${labelText}</span>`;
        if (ac.attachment) {
          const btn = document.createElement("a");
          btn.href = ac.attachment;
          btn.target = "_blank";
          btn.classList.add("btn", "btn-outline-secondary", "btn-sm", "ms-2");
          btn.innerHTML = `<i class="bi bi-paperclip"></i> Open`;
          btn.addEventListener("mousedown", () => {
            btn.style.transform = "scale(0.95)";
          });
          btn.addEventListener("mouseup", () => {
            btn.style.transform = "scale(1)";
          });
          item.appendChild(btn);
        }
        item.addEventListener("mouseenter", () => {
          item.classList.add("hovered");
          highlightPositions(ac.positions);
          highlightSkillBubbles(ac.skills);
        });
        item.addEventListener("mouseleave", () => {
          item.classList.remove("hovered");
          unhighlightAllPositions();
          unhighlightAllSkills();
        });
        container.appendChild(item);
      });
    }
    function initPositionHover() {
      document.querySelectorAll(".position-card").forEach((card) => {
        card.addEventListener("mouseenter", () => {
          const rect = document.querySelector(
            `.timeline-rect[data-id='${card.getAttribute("data-id")}']`
          );
          if (rect) rect.classList.add("hovered");
          const skillNames = (card.getAttribute("data-skills") || "")
            .split(",")
            .map((s) => s.trim())
            .filter(Boolean);
          highlightSkillBubbles(skillNames);
          highlightAccomplishments({
            positions: [card.getAttribute("data-id")],
            skills: skillNames,
          });
          document.querySelectorAll(".timeline-rect").forEach((r) => {
            if (r.getAttribute("data-id") !== card.getAttribute("data-id"))
              r.classList.add("dimmed");
          });
        });
        card.addEventListener("mouseleave", () => {
          const rect = document.querySelector(
            `.timeline-rect[data-id='${card.getAttribute("data-id")}']`
          );
          if (rect) rect.classList.remove("hovered");
          unhighlightAllSkills();
          unhighlightAccomplishments();
          document.querySelectorAll(".timeline-rect").forEach((r) => {
            r.classList.remove("dimmed");
          });
        });
      });
    }

    function simpleHash(str) {
      let hash = 0;
      for (let i = 0; i < str.length; i++) {
        hash = (hash << 5) - hash + str.charCodeAt(i); // Bitwise hash
        hash |= 0; // Convert to 32-bit integer
      }
      return Math.abs(hash); // Ensure positive value
    }

    function getProfileImage(email, yamlImage) {
      if (yamlImage) {
        return yamlImage; // Use the image from YAML if provided
      }

      if (email) {
        const emailHash = simpleHash(email.trim().toLowerCase());
        return `https://api.dicebear.com/7.x/identicon/svg?seed=${emailHash}`;
      }

      return "https://ui-avatars.com/api/?name=User&size=150"; // Default placeholder
    }
    // Import the passphrase as a CryptoKey using PBKDF2.
    async function importKey(passphrase) {
      const enc = new TextEncoder();
      const keyMaterial = await crypto.subtle.importKey(
        "raw",
        enc.encode(passphrase),
        { name: "PBKDF2" },
        false,
        ["deriveKey"]
      );
      if (!(keyMaterial instanceof CryptoKey)) {
        throw new Error(config.translations[currentLanguage].invalid_key_material);
      }
      return keyMaterial;
    }

    // Derive an AES-GCM key from the passphrase and provided salt.
    async function deriveKey(passphrase, salt) {
      const keyMaterial = await importKey(passphrase);
      const derivedKey = await crypto.subtle.deriveKey(
        {
          name: "PBKDF2",
          salt: salt,
          iterations: 100000,
          hash: "SHA-256"
        },
        keyMaterial,
        { name: "AES-GCM", length: 256 },
        false,
        ["encrypt", "decrypt"]
      );
      console.log("Derived key:", derivedKey);
      return derivedKey;
    }

    // Decrypt the encrypted YAML configuration.
    async function decryptText(encryptedData, passphrase) {
      try {
        const data = JSON.parse(encryptedData);
        const salt = Uint8Array.from(atob(data.salt), c => c.charCodeAt(0));
        const iv = Uint8Array.from(atob(data.iv), c => c.charCodeAt(0));
        const ciphertext = Uint8Array.from(atob(data.ciphertext), c => c.charCodeAt(0));
        const key = await deriveKey(passphrase, salt);
        const decryptedBuffer = await crypto.subtle.decrypt(
          { name: "AES-GCM", iv: iv },
          key,
          ciphertext
        );
        const result = new TextDecoder().decode(decryptedBuffer);
        if (!result) {
          throw new Error(config.translations[currentLanguage].empty_decryption_result);
        }
        return result;
      } catch (error) {
        throw new Error(config.translations[currentLanguage].decryption_error.replace("{error}", error.message));
      }
    }

    // Initialize passphrase UI and handler
    function initPassphraseHandler() {
      const toggleBtn = document.getElementById("toggle-passphrase");
      const passInput = document.getElementById("passphrase-input");
      toggleBtn.addEventListener("click", function () {
        if (passInput.type === "password") {
          passInput.type = "text";
          toggleBtn.innerHTML = '<i class="bi bi-eye-slash"></i>';
        } else {
          passInput.type = "password";
          toggleBtn.innerHTML = '<i class="bi bi-eye"></i>';
        }
      });
      // Also allow hitting "Enter" to trigger submit
      passInput.addEventListener("keypress", function (event) {
        if (event.key === "Enter") {
          event.preventDefault();
          document.getElementById("passphrase-submit").click();
        }
      });
      // On clicking the Unlock button, try to decrypt the YAML
      document.getElementById("passphrase-submit").addEventListener("click", async function () {
        const passphrase = passInput.value.trim();
        if (!passphrase) {
          alert(config.translations[currentLanguage].passphrase_required);
          return;
        }
        const encryptedYAML = document.getElementById("custom-config").textContent.trim();
        let decryptedYAML;
        try {
          decryptedYAML = await decryptText(encryptedYAML, passphrase);
          if (!decryptedYAML) {
            throw new Error("Empty decryption result. Possibly an incorrect passphrase.");
          }
        } catch (error) {
          alert(config.translations[currentLanguage].decryption_failed.replace("{error}", error.message));
          return;
        }
        try {
          const newConfig = jsyaml.load(decryptedYAML);
          config = newConfig;
          if (config.page_title) document.title = config.page_title;
          if (config.cv_timestamp) document.getElementById("cv-timestamp").textContent = "Created: " + config.cv_timestamp;
          populatePersonalInfo(config.personal_info);
          populatePositions(config.positions);
          populateSkills(config.skills);
          populateAccomplishments(config.accomplishments);
          updateTranslations();
          initTimeline();
          initPositionHover();
          alert(config.translations[currentLanguage].decryption_success);
        } catch (error) {
          alert(config.translations[currentLanguage].yaml_parse_failed.replace("{error}", error.message));
          return;
        }
      });
    }

    function initCV() {
      const defaultText =
        document.getElementById("default-config").textContent;
      config = jsyaml.load(defaultText);
      if (config.page_title) document.title = config.page_title;
      if (config.cv_timestamp)
        document.getElementById("cv-timestamp").textContent =
          "Created: " + config.cv_timestamp;
      populatePersonalInfo(config.personal_info);
      populatePositions(config.positions);
      populateSkills(config.skills);
      populateAccomplishments(config.accomplishments);
      updateTranslations();
      initTimeline();
      initPositionHover();
      initClipboardHandlers();
      initButtonBounceEffect();
      initPassphraseHandler();
    }
    let currentLanguage = "en";
    let config = null;
    let selectedSkill = null;
    let disableSkillAnimation = false;

    document.addEventListener("DOMContentLoaded", initCV);
    document.addEventListener("click", function (event) {
      if (!event.target.closest(".skill-bubble") && selectedSkill !== null) {
        selectedSkill = null;
        d3.selectAll(".skill-bubble").classed("selected", false);
        document.querySelectorAll(".position-card").forEach((card) => {
          card.classList.remove("dimmed", "highlighted");
        });
        showToastSkillFilter("");
      }
    });
    let resizeTimer;
    window.addEventListener("resize", () => {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(() => {
        initSkillTree();
        initTimeline();
      }, 200);
    });
    /*]]>*/
  </script>
</body>

</html>
